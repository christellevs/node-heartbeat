<p align="center">
  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="200" alt="Nest Logo" /></a>
</p>

[circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
[circleci-url]: https://circleci.com/gh/nestjs/nest

  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
    <p align="center">
<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
<a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
<a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
<a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
<a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
  <a href="https://paypal.me/kamilmysliwiec" target="_blank"><img src="https://img.shields.io/badge/Donate-PayPal-ff3f59.svg"/></a>
    <a href="https://opencollective.com/nest#sponsor"  target="_blank"><img src="https://img.shields.io/badge/Support%20us-Open%20Collective-41B883.svg" alt="Support us"></a>
  <a href="https://twitter.com/nestframework" target="_blank"><img src="https://img.shields.io/twitter/follow/nestframework.svg?style=social&label=Follow"></a>
</p>
  <!--[![Backers on Open Collective](https://opencollective.com/nest/backers/badge.svg)](https://opencollective.com/nest#backer)
  [![Sponsors on Open Collective](https://opencollective.com/nest/sponsors/badge.svg)](https://opencollective.com/nest#sponsor)-->

## Description

[Nest](https://github.com/nestjs/nest) framework TypeScript starter repository.

## Set up environment

Create a .env file and add:

```
DATABASE_URL="mongodb+srv://cooluser:coolpassword@node-heartbeat.p1yr3un.mongodb.net/%3FretryWrites=true&w=majority"
```

## Installation

```bash
$ npm install
```

## Running the app

```bash
# development
$ npm run start

# watch mode
$ npm run start:dev

# production mode
$ npm run start:prod
```

## Test

```bash
# unit tests
$ npm run test

# e2e tests
$ npm run test:e2e

# test coverage
$ npm run test:cov
```

## Support

Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).

## Stay in touch

- Author - [Kamil My≈õliwiec](https://kamilmysliwiec.com)
- Website - [https://nestjs.com](https://nestjs.com/)
- Twitter - [@nestframework](https://twitter.com/nestframework)

## License

Nest is [MIT licensed](LICENSE).

---

# Original README

# Backend Developer Technical Test

Hi there!

We are excited about you considering to join our small team of dedicated engineers.

Below you will find a technical test that will help us understand your ability to write clean concise code, which is easy to reason about, maintain and support. We are also keen on seeing your approach to naming (because we know how hard naming is!) and structuring the entities around your codebase, as well as testing and documenting them.

Good luck, and looking forward to welcome you aboard.

## Spec

Implement a RESTful horizontally scalable discovery service.

The idea is simple: a number of different client applications will periodically send heartbeats to this service, and the service keeps track of them, periodically removing those that didn't send any heartbeats in some configured time frame.

### Endpoints

The service should expose the following endpoints:

- `POST /:group/:id`

  - registers an application instance in specified `group`
  - `id` is a unique identifier of application instance, generated by client
  - if instance is already registered, the `updatedAt` timestamp must be updated
  - the request body can specify meta information that will be attached to the instance
  - returns JSON with following structure:

    ```js
    {
        "id": "e335175a-eace-4a74-b99c-c6466b6afadd",   // echoed from path parameter
        "group": "particle-detector",                   // echoed from path parameter
        "createdAt": 1571418096158,                     // first registered heartbeat
        "updatedAt": 1571418124127,                     // last registered heartbeat
        "meta": {                                       // meta echoed from request body
            "foo": 1
        }
    }
    ```

- `DELETE /:group/:id`

  - unregisters an application instance

- `GET /`

  - returns a JSON array containing a summary of all currently registered groups as follows:

    ```js
    [
      {
        group: 'particle-detector',
        instances: '4', // the number of registered instances in this group
        createdAt: 1571418124127, // first heartbeat registered in this group
        lastUpdatedAt: 1571418124127, // last heartbeat registered in this group
      },
      // ...
    ];
    ```

  - groups containing 0 instances should not be returned

- `GET /:group`

  - returns a JSON array describing instances of the `group`:

    ```js
    [
      {
        id: 'e335175a-eace-4a74-b99c-c6466b6afadd',
        group: 'particle-detector',
        createdAt: 1571418096158,
        updatedAt: 1571418124127,
        meta: {
          foo: 1,
        },
      },
      // ...
    ];
    ```

The service should periodically remove expired instances. The "age" of the most recent heartbeat of an instance to be considered expired should be configurable with environment variable and have a sensible default value.

## Our expectations

- A service should be implemented in Node.js, with README containing steps to get it up and running.
- TypeScript with `strict: true` is strongly encouraged, but not 100% required.
- Unless something is explicitly stated in Spec, please choose how to approach the specifics.
  - If some use cases are missing in Spec but important, please do cover them in your solution as well. Don't forget to document important implementation decisions.
  - Feel free to challenge the Spec if something does not add up, or can be done more elegantly and/or efficiently. We appreciate the ability to work with the requirements.
- Feel free to use latest Node version (we don't like legacy either!)

## Submitting solution

- Create a repository on GitHub and/or BitBucket, push your code there and send us a link.
- If you choose to use a private repository, download your code as ZIP and attach it to the email.
- Optional: Deploying the solution to some public service like Glitch
- Optional: Showing a green CI page would also be beneficial
